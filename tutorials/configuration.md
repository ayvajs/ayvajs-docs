> This tutorial assumes that you have completed the <a href="./tutorial-getting-started.html" target="_blank">Getting Started</a> tutorial, and that you have some familiarity with <a href="https://www.patreon.com/tempestvr" target="_blank">Open Source Multi Axis Stroker Robots</a>, TCode, and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript" target="_blank">JavaScript</a>.

## Default Configuration
To control a device with an instance of Ayva, the axes for the device must be configured. The default configuration consists of the axes needed to control an OSR2 or SR6 device: 

<div class="table-container" style="max-width: 300px">
  <table>
    <thead>
      <tr>
        <th style="font-weight: bold">Axis</th>
        <th style="font-weight: bold">Type</th>
        <th style="font-weight: bold">Alias</th>
      </tr>
    </thead>
    <tbody>
      <tr class="deep-level-0">
        <td class="name"><code>L0</code></td>
        <td class="default">linear</td>
        <td class="description last">stroke</td>
      </tr>
      <tr class="deep-level-0">
        <td class="name"><code>L1</code></td>
        <td class="default">linear</td>
        <td class="description last">surge</td>
      </tr>
      <tr class="deep-level-0">
        <td class="name"><code>L2</code></td>
        <td class="default">linear</td>
        <td class="description last">sway</td>
      </tr>
      <tr class="deep-level-0">
        <td class="name"><code>R0</code></td>
        <td class="default">rotation</td>
        <td class="description last">twist</td>
      </tr>
      <tr class="deep-level-0">
        <td class="name"><code>R1</code></td>
        <td class="default">rotation</td>
        <td class="description last">roll</td>
      </tr>
      <tr class="deep-level-0">
        <td class="name"><code>R2</code></td>
        <td class="default">rotation</td>
        <td class="description last">pitch</td>
      </tr>
      <tr class="deep-level-0">
        <td class="name"><code>A0</code></td>
        <td class="default">auxiliary</td>
        <td class="description last">valve</td>
      </tr>
      <tr class="deep-level-0">
        <td class="name"><code>A1</code></td>
        <td class="default">auxiliary</td>
        <td class="description last">suck</td>
      </tr>
      <tr class="deep-level-0">
        <td class="name"><code>A2</code></td>
        <td class="default">auxiliary</td>
        <td class="description last">lube</td>
      </tr>
      <tr class="deep-level-0">
        <td class="name"><code>V0</code></td>
        <td class="default">auxiliary</td>
        <td class="description last">vibe0</td>
      </tr>
      <tr class="deep-level-0">
        <td class="name"><code>V1</code></td>
        <td class="default">auxiliary</td>
        <td class="description last">vibe1</td>
      </tr>
    </tbody>
  </table>
</div>
  
An instance of Ayva can use the default configuration by calling the ```defaultConfiguration()``` method:
  
```javascript
const ayva = new Ayva();
ayva.defaultConfiguration();
```
This method also returns the Ayva instance itself, allowing the above code to be reduced to one line:
```javascript
const ayva = new Ayva().defaultConfiguration();
```
<br/>

After axes have been configured (and an output has been added) Ayva can begin generating TCode:

```javascript
// Move the twist axis to position zero over 1 second.
ayva.move({
  axis: 'twist', // An axis can be referred to by its name or alias (i.e. 'R0' would also work here).
  to: 0,
  duration: 1
});
```

_Note: The Motion API is explained in greater detail in the next tutorial._

## Outputs
Ayva can output to a function or any object with a ```write()``` method. This allows the flexibility to connect to any kind of output. The following example just logs the TCode generated to the console:

```javascript
const ayva = new Ayva().defaultConfiguration();

ayva.addOutput(console.log);

// The TCode generated by the following command would simply be output to the console.
ayva.move({
  axis: 'L0',
  to: 1,
  speed: 2
});
```

When Ayva is being used within a web application, the convenience class <a href="./WebSerialDevice.html" target="_blank">WebSerialDevice</a> may be used to connect to an actual device. For graphical simulation, there is the <a href="https://github.com/ayvajs/osr-emu" target="_blank">OSR Emulator</a>. In a Node.js app, the serial library <a href="https://serialport.io/" target="_blank">serialport</a> may be used.

## Axis Limits

Axis values in Ayva are specified in the range [0, 1]. Internally, when values are translated to TCode they are scaled to the range [0, 9999]. For example, the following would result in the L0 axis moving to position 9999:

```javascript
ayva.move({
  axis: 'L0',
  to: 1,
  duration: 1
});
```
<br/>  

An axis can be configured to scale values to a smaller range. For existing axes this can be done with the ```updateLimits()``` method:

```javascript
ayva.updateLimits('pitch', 0.3, 0.7);

// The following would now result in the pitch axis moving to about position 7000.
ayva.move({
  axis: 'pitch',
  to: 1,
  duration: 1
});
```
<h2 id="custom-configuration">Custom Axis Configuration</h2>

An axis configuration consists of the following parameters:

<div class="table-container">
  <table class="params table">
    <thead>
      <tr>
        <th style="font-weight: bold">Parameter</th>
        <th style="font-weight: bold">Type</th>
        <th style="font-weight: bold">Attributes</th>
        <th style="font-weight: bold">Default</th>
        <th style="font-weight: bold" class="last">Description</th>
      </tr>
    </thead>
    <tbody>
      <tr class="deep-level-0">
        <td class="name"><code>name</code></td>
        <td class="type">
          <span class="param-type">String</span>
        </td>
        <td class="attributes">
        </td>
        <td class="default">
        </td>
        <td class="description last">
          <p>the machine name of the axis (such as L0, R0, etc...)</p>
        </td>
      </tr>
      <tr class="deep-level-0">
        <td class="name"><code>type</code></td>
        <td class="type">
          <span class="param-type">String</span>
        </td>
        <td class="attributes">
        </td>
        <td class="default">
        </td>
        <td class="description last">
          <p>linear, rotation, or auxiliary</p>
        </td>
      </tr>
      <tr class="deep-level-0">
        <td class="name"><code>alias</code></td>
        <td class="type">
          <span class="param-type">String</span>
        </td>
        <td class="attributes">
          &lt;optional&gt;<br>
        </td>
        <td class="default">
        </td>
        <td class="description last">
          <p>an alias used to refer to the axis (such as twist, pitch, stroke, etc)</p>
        </td>
      </tr>
      <tr class="deep-level-0">
        <td class="name"><code>max</code></td>
        <td class="type">
          <span class="param-type">Number</span>
        </td>
        <td class="attributes">
          &lt;optional&gt;<br>
        </td>
        <td class="default">
          1
        </td>
        <td class="description last">
          <p>specifies maximum value for the axis</p>
        </td>
      </tr>
      <tr class="deep-level-0">
        <td class="name"><code>min</code></td>
        <td class="type">
          <span class="param-type">Number</span>
        </td>
        <td class="attributes">
          &lt;optional&gt;<br>
        </td>
        <td class="default">
          0
        </td>
        <td class="description last">
          <p>specifies minimum value for the axis</p>
        </td>
      </tr>
      <tr class="deep-level-0">
        <td class="name"><code>defaultValue</code></td>
        <td class="type">
          <span class="param-type">Number</span>
        </td>
        <td class="attributes">
          &lt;optional&gt;<br>
        </td>
        <td class="default">
          0.5 for linear axes, 0 for auxiliary
        </td>
        <td class="description last">
          <p>specifies the default value for the axis</p>
        </td>
      </tr>
      <tr class="deep-level-0">
        <td class="name"><code>resetOnStop</code></td>
        <td class="type">
          <span class="param-type">Boolean</span>
        </td>
        <td class="attributes">
          &lt;optional&gt;<br>
        </td>
        <td class="default">
          false
        </td>
        <td class="description last">
          <p>setting this flag will send the axis to its default value when ayva.stop() is called.</p>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<br/>

The ```configureAxis()``` method can be used to configure a single axis:

```javascript
ayva.configureAxis({
  name: 'C0',
  type: 'linear',
  alias: 'custom',
  max: 0.9,
  min: 0.1,
});

ayva.move({ 
  axis: 'C0',
  to: 0,
  speed: 1,
});
```
<br/>

Alternatively a configuration object with multiple axes can be passed to Ayva's <a href="./Ayva.html#Ayvaconstructor" target="_blank">constructor</a>.

```javascript
// Create a new config that only consists of the stroke and roll axis (an OSR2 without any mods)
const config = {
  name: 'OSR2',      // Optional name of the config.
  defaultAxis: 'L0', // Optional default axis. When an axis is not specified in commands, this axis is used.
  frequency: 50,     // Optional. The frequency of updates to devices in Hz. The default is 50.
  axes: [{
    name: 'L0',
    type: 'linear',
    alias: 'stroke'
  },{
    name: 'R1',
    type: 'rotation'
    alias: 'roll'
  }]
};

const ayva = new Ayva(config);
```


<div style="text-align: center; font-size: 18px">Next: <a href="./tutorial-motion-api.html">Motion API</a></div>
